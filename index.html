<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chicago Crime COVID-19 Analysis</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.0/nouislider.min.css" rel="stylesheet">
</head>
<body>
    <div class="container"> <!-- Centers content and sets max width -->
        <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
            <h1>COVID-19 and Crime Distribution in Chicago</h1>
            <p id="status-text" style="margin-right: 10%;"></p>
        </div>
        <!-- Controls section -->
        <div class="controls-section" style="padding-bottom: 50px;">
            <div style="width: 75%;margin: 0 auto; display: flex; flex-direction: column; align-items: flex-start;">
                <h2>Controls</h2>
                <div id="slider" style="width: 100%;">
                </div>  
            </div>
        </div>

        <hr style="width: 100%; margin: 0 auto;">
        
        <!-- Visualization section with flex layout -->
        <div class="visualization-container">
            <!-- Left column with pie charts (stacked) -->
            <div class="charts-column">
                <!-- First pie chart -->
                <div class="visualization-section">
                    <h2>Crime Categories</h2>
                    <div id="crime-type-vis" class="vis-element"></div>
                </div>
                
                <!-- Second pie chart -->
                <div class="visualization-section">
                    <h2>Location Categories</h2>
                    <div id="location-type-vis" class="vis-element"></div>
                </div>
            </div>
            
            <!-- Right column with map -->
            <div class="map-column">
                <!-- Map visualization -->
                <div class="visualization-section">
                    <h2>Crime Type by Location Heatmap</h2>
                    <div id="grid-heatmap-vis" class="vis-element"></div>
                </div>
            </div>
        </div>
        <p class="description">This is an interactive visualization of crime distribution across location, crime category and time as well as correlation between crime and location in the city of Chicago during the years of the COVID-19 pandemic and the following years (2020-2023). To accomplish this, we preprocessed public City of Chicago crime data from 2001-present, parsing only the years 2020-2023 and discarding crimes with null values using pandas in python. We chose to focus on crime type (primary crime type), and crime location description (location description) as well as the time of the arrest (year and date).</p>
    </div>
    
    <!-- Load D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-pip/leaflet-pip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.7.0/nouislider.min.js"></script>
    <script>
    // Initialize placeholders immediately when the page loads
    document.addEventListener('DOMContentLoaded', () => {
        // Add placeholders to each visualization container
        const crimeTypeVis = document.getElementById('crime-type-vis');
        const locationTypeVis = document.getElementById('location-type-vis');
        const heatmapVis = document.getElementById('grid-heatmap-vis');
        
        // Add placeholder to crime type visualization
        crimeTypeVis.innerHTML = `
            <div style="width: 600px; height: 300px; background-color: lightgray;">
            </div>
        `;
        
        // Add placeholder to location type visualization
        locationTypeVis.innerHTML = `
            <div style="width: 600px; height: 300px; background-color: lightgray;">
            </div>
        `;
        
        // Add placeholder to heatmap visualization
        heatmapVis.innerHTML = `
            <div style="width: 800px; height: 600px; background-color: lightgray;">
            </div>
        `;
        
        console.log('Placeholders initialized');
    });
    </script>
    <script src="js/script.js"></script>
</body>
</html>